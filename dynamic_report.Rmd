---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)

```

```{css}
body {
  color: #D60265;
  background-color: #ffffe5;
  font-family: serif
  
}
```

## Ads seen whilst on social media


library(tidyverse)
logged_data <- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vR6F7RwSGQIJ4_z8o1I_lDmgSY0OXXLRriy1z8NUka-mRN0jPE4P7aC3RGvcFru6V2sRU5dzZkuaV2E/pub?gid=1723247763&single=true&output=csv")

#PART D making summary values and plots

colnames(logged_data)
```{r}
#rename all my varibles. 
latest_data <- logged_data %>%
  rename(
    first_seen = "Was the first post or story on your feed an ad or regular content?",
    number_ads = "How many ads did you see during this scroll session?",
    first_ad = "What was the first ad about?",
    majority = "What were majority of the ads about during this scroll session?",
    platform_used = "What platform were you using when you saw the ad?",
    ad_revelance ="Were these ads relevant to you?",
    length_scroll = "Approximately how long was the scroll session?"
    
  )
```
```{r}
#First summary value(average number of ads per scroll)

average <- mean(latest_data$number_ads, na.rm = TRUE) %>% round(1)

#comment
paste("On average, social media users saw", average, "ads per scroll session")

#Second summary value( majority of the ads)
majority_of_ads <- names(which.max(table(latest_data$majority)))


#comment
paste("The most common type of ads during scroll sessions was", majority_of_ads, ".")

#third summary value(commonly used platform)
most_used <- names(which.max(table(latest_data$platform_used)))
paste("The most commonly used platform during scroll sessions was", most_used)


```

#ADDING BAR CHARTS
```{r}
ggplot (latest_data) +
  geom_bar(aes(x=platform_used)) +
  labs(title = "Platform Used During Scroll Session",
       x = "Platform",
       y = "Frequency") +
  theme_minimal()

ggplot(latest_data, aes(x = majority)) + 
  geom_bar(fill = "salmon") +
  labs(title = "Main Topics of Ads Seen on Social Media",
       x = "Ad Topic",
       y= "Count") +
  theme_minimal()



```

The best pet to have is a `r best_pet` of course!

![](https://c.tenor.com/-qBsG1HwR4oAAAAC/tenor.gif)
